<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Widget v3.0</title>
    <style>
        /* --- CSS STYLES --- */
        body {
            margin: 0;
            padding: 0;
            /* CHANGED TO BLUE TO VERIFY UPDATE */
            background: #0f172a; 
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: sans-serif;
            color: white;
        }

        .main-container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .widget-box {
            width: 240px;
            height: 240px;
            background: rgba(30, 41, 59, 0.8); /* Blue-ish tint */
            border-radius: 20px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        /* VERSION MARKER */
        .version-tag {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 10px;
            color: #4ade80; /* Green text */
            font-weight: bold;
            background: rgba(0,0,0,0.5);
            padding: 2px 6px;
            border-radius: 4px;
        }

        /* CLOCK */
        #time { font-size: 48px; font-weight: bold; margin-bottom: 5px; }
        #date { font-size: 14px; opacity: 0.8; }

        /* WEATHER */
        #weather-icon { font-size: 48px; margin-bottom: 5px; }
        #temp { font-size: 32px; font-weight: bold; }
        #condition { font-size: 14px; opacity: 0.8; margin-bottom: 15px; }
        
        /* HIDDEN UPLOAD FOR LATER */
        input[type="file"] { display: none; }
        
        /* BACKGROUND IMAGE (Optional) */
        .bg-img {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover;
            opacity: 0.2;
            border-radius: 20px;
            pointer-events: none;
            z-index: 0;
        }
        .content { z-index: 1; text-align: center; }

    </style>
</head>
<body>

    <input type="file" id="imgUpload" accept="image/*">

    <div class="main-container">
        <div class="widget-box" onclick="document.getElementById('imgUpload').click()">
            <div class="version-tag">v3.0 TEST</div> <img class="bg-img custom-bg" src=""> <div class="content">
                <div id="time">00:00</div>
                <div id="date">Loading System...</div>
            </div>
        </div>

        <div class="widget-box">
            <div class="version-tag">v3.0 TEST</div>
            <img class="bg-img custom-bg" src="">
            
            <div class="content">
                <div style="font-size:12px; margin-bottom:10px; font-weight:bold; color:#94a3b8;">LAS PIÑAS</div>
                <div id="weather-icon">☀️</div>
                <div id="temp">--°</div>
                <div id="condition">Checking...</div>
            </div>
        </div>
    </div>

    <script>
        // 1. SIMPLE CLOCK START
        function updateTime() {
            const now = new Date();
            // Manual formatting to be safe
            let h = now.getHours();
            let m = now.getMinutes();
            let s = now.getSeconds();
            // Add leading zeros
            h = h < 10 ? '0'+h : h;
            m = m < 10 ? '0'+m : m;
            s = s < 10 ? '0'+s : s;
            
            document.getElementById('time').innerText = h + ":" + m + ":" + s;
            document.getElementById('date').innerText = now.toDateString();
        }
        
        // Run immediately, then every second
        setInterval(updateTime, 1000);
        updateTime();

        // 2. SIMPLE WEATHER START
        async function updateWeather() {
            try {
                const res = await fetch('https://api.open-meteo.com/v1/forecast?latitude=14.4457&longitude=120.9836&current=temperature_2m,weather_code&timezone=Asia%2FManila');
                const data = await res.json();
                
                document.getElementById('temp').innerText = Math.round(data.current.temperature_2m) + "°";
                document.getElementById('condition').innerText = "Code: " + data.current.weather_code;
            } catch(e) {
                document.getElementById('condition').innerText = "Offline Mode";
            }
        }
        updateWeather();

        // 3. BACKGROUND IMAGE LOADER
        // Looks for 'background.jpg' in GitHub. 
        const bgImg = new Image();
        bgImg.onload = function() {
            // Only sets if image exists
            document.querySelectorAll('.custom-bg').forEach(el => el.src = 'background.jpg');
        }
        bgImg.src = 'background.jpg';

        // 4. CLICK TO UPLOAD (Temporary)
        document.getElementById('imgUpload').addEventListener('change', function(e) {
            if(e.target.files && e.target.files[0]) {
                const reader = new FileReader();
                reader.onload = function(ev) {
                    document.querySelectorAll('.custom-bg').forEach(el => el.src = ev.target.result);
                }
                reader.readAsDataURL(e.target.files[0]);
            }
        });
    </script>
</body>
</html>
